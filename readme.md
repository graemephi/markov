## markov.c

Not a library, sorry.

Some experiments with markov chain text generation. Instead of training a single markov chain on multiple texts, compose markov chains. You can even train multiple chains on a single text. Here's output from a markdown version of D&D 5th Edition, a 2nd order markov chain whose transition probabilities are augmented by 16 1st order markov chains where the nth chain looks n tokens back, with squared fall off. This still obeys the 'markov property', but the window is 16 tokens long:

>Unique tokens: 11159
>Tokenise: 0.019s
>Analyse: 0.629s
>Generate: 0.078s
>2-0-1: 0 (0 rejected)
>1-0-1: 2867 (33427 rejected)
>1-1-1: 839 (13611 rejected)
>1-2-1: 171 (13435 rejected)
>1-3-1: 77 (7724 rejected)
>1-4-1: 37 (3722 rejected)
>1-5-1: 18 (2842 rejected)
>1-6-1: 18 (2037 rejected)
>1-7-1: 15 (1399 rejected)
>1-8-1: 3 (1168 rejected)
>1-9-1: 8 (1006 rejected)
>1-10-1: 10 (850 rejected)
>1-11-1: 7 (734 rejected)
>1-12-1: 3 (526 rejected)
>1-13-1: 2 (485 rejected)
>1-14-1: 2 (416 rejected)
>1-15-1: 0 (392 rejected)
>1-16-1: 1 (330 rejected)
> and it regains 1d3 expended charges daily at dawn. While wearing the ring, you can use your Dexterity (Stealth) check to control its user a + 5 to hit, you can find your way home. While you are proficient in the spell, but can't doff it unless you have disadvantage on a spell slot, you are attuned to the circle, your walking speed is doubled for the spell slots.
>**Components:** 1 / 2 | 6 | 2 | 1d6 |
>
>
> ###  Stunning Strike
>_6th - level spell slot and three times the normal damage of your next long rest.
> #  Damage and Healing
>
> The game organizes the chaos of combat.
> An ability check.
>
> You can draw two additional undead creatures for the same action you can be used for a service that only you can choose two of the rod, you are so evasive that attackers rarely gain the same materials worth at least 20 feet of the duration of your turn, the target. The cube regains 1d3 expended charges daily at dawn. The creature is an attack during its duration. For instance, the swarm and ends the effect, and your proficiency with a 6th - level slot. name: Chill Touch
>**Senses** blindsight 60 ft.
>
>
> | 18 | 4 (+ 7) | 5 (1d4 + 2 bonus to the roll, and the creature it has. During a short rest. You start with two hands to make a saving throw or follow the same size and the bead has not yet detonated, the smoke of a single craft. Each creature that starts its turn.
>_1st - level divination_
>**Hit Dice
> You can either use the creature with a damage roll, or destroy the servants of a creature and the spell equals 8 + your proficiency bonus, you can use its claws.
>**Martial Advantage.** The Travel Pace
> While holding the item, such that specified creatures to make your first attack on the spell end after it rolls a 5, the spell to end the spell ends, and the long - term madness.
>**Skills** Perception + 5 to hit, reach, the creature can see in the target ends.
>**Casting Time:** 10 + your spellcasting ability to move, you take an action.
>_Large celestial, which is equal to or higher level.
>**Legendary Resistance (3) slashing damage if you and creatures can't cross through the creature.
>* **Casting Time: 1
>
>**Keen Smell.** The creature can repeat the attack and, if a spell slot, you can't set in a spell.
>**Armor Class** 12 (+ 4, the creature is an object. name: Vorpal Sword
> type: beast
> cr: 2
>
>* **Casting Time:** 60 (8d8 + 4)
>
>_Medium construct, it must succeed on saving throws, and when it ends its turn there, you and the creature is to open a door, or as an action that you can normally lift.
>**Hit**"notation.
> This tube holds milky liquid with a 10 - ­foot radius and can be reached by climbing to the weapon.
> >**3. name: Hell Hound
>_Wand, rare (+ 5) slashing damage.
>
> | 1 | + 0
>**Components:** Concentration, up to the creature is a 1st - level evocation (ritual)_
>
> #  Gold Dragon
> type: ooze
> cr: 13
>
>
>
>**Armor:** 8 + your Intelligence, Wisdom, and you cast a cleric with a 15 - foot - radius sphere centered on a failed save, or you finish a long rest, up to the one with its dagger. Or you can be terrible villains.
>_Wondrous item, its hit points for 1 round).
>**Skills** Perception + 4 to hit, you use persuasion when acting in good standing with your unarmed strikes as a creature that knows at least one of its turn in a magic staff or wand, the same for all creatures, you make the spell's choice.
>**Speed.** The elemental makes two greataxe attacks.
>**Duration:** 30 ft., one target or a bonus to its speed.
>**Iron Scent.** When you finish a long - term or long rest, you move to the creature takes 10 minutes.
>
> | Druid |
>
>
> #  Darkvision
>_Wondrous item, the spell's gaze for the damage, the most common modifiers to the ring's space. You create an effect.
>_3rd - level and again at 6th, 11th, and might decide to attack a creature within 5 feet of the wounded creature's damage increases as you have carefully studied, or (b) a scholar's pack, and the effect, you use a spell, or dirt. name: Adult White Dragon
>_7th - level spells, you use your spellcasting ability of the new roll.
>**Keen Smell.** Until the end of the spell. |
>| Vial | 1 minute (no taller than a single creature or an action, it is a place that doesn't survive without the staff and serpents | NE | Trickery | Flaming snake |
>| Bast, goddess of the wolf's name, you gain temporary hit points to a creature's long range. The dragon can move through its space.
>**Armor Class** 12 (+ 1), very rare (+ 2) piercing damage. name: Lamia
>_7th - level transmutation_
>
>
> ##  Actions
> If the doppelganger's natural inclinations, alignment, the same in each case.
>_Large beast, unaligned_
>
>
> ###  Range
> You start with the same, however, or, if it can, and slashing damage.
>**Innate Spellcasting (1 day.
>
>
>**Casting Time:** 60 ft.
> You can breathe air and water, it can use it. If the vampire fails a DC 17 Strength saving throw at the target must make a successful Constitution saving throw it to a life - or - death struggle, while you have resistance to the object and takes a short rest. The vampire can't require attack rolls against a creature if the target falls prone.
> When the creature._Hit:_ 7 (1d10) fire damage. name: Storm of Vengeance
>_Small beast, neutral_
>
> | 21 | + 4)
>**Drop.** The spell lasts, you might ask the creature can, and speak a one - hour ritual to break your concentration. name: Will - o'- wisp can't use any special modifiers.
>
>* You can use an action. For the next 24 hours.
>
>**Range:** 60 feet of you can reach |
> | 13 (+ 1, and it can make an area.
>**Skills:** 30 (7d6) poison damage. The dragon can use this action to break the gem.
>**Languages** the languages of its wielder, the creature's allies is within 30 feet straight toward it.
>**Components:** Concentration, up to the thing you can't be used to learn the surface of the time the target can be a single creature or a spell's interaction with the environment, and can pass through the ground, the area, provided the scales of a 5th - level spellcaster.
>**Challenge** 17 (2d12 + 4) | 15 | You (the dragon.
>**Ram.** The ground in that area must succeed on the creature, it projects an illusion that lasts for the purpose of this feature. The target gains a + 10 |
>
>**Duration:** 60 ft., one target.
> A creature's Frightful Presence.** You must be a single - classed member of this spell's vision starts to become the target creature, the object, you apply a proficiency bonus to its AC value.
>**Deadly Leap.** If you have advantage on the target can use only one target.
>_5th - level or a metal weapon, it must succeed on a DC 24 Strength saving throw or take the same effect.
> The webs fill a 30 - foot cone of fire or pit, but can target an object's control, and a giant of the target
>* Nature
>_3rd - level conjuration_
>**Damage Immunities** blinded
>**Saving Throws:** 30 (+ 10 | 18 | + 2, 000) |
>
>_Magic trap_
>**Casting Time:** 1 / 4 (+ 0) |
> | 6 gp | 11 (+ 3) | 14 | + 1) | 23 | + 11 to hit, the armor's Frightful Presence for the duration, but can be cast in this way.
>**Duration:** Self
>**Bite.** Any creature that you can use an action to become invisible at the end of a green dragon's goals to the weapon's Strength (Athletics) check.
> Beginning at 9th. Cantrips - - -
>
>
>
>**Challenge** 1 minute
>
> You can attempt a Wisdom saving throw and take the same in each case.
> #  Pass without Trace
> level: 6
>
> In addition, the same for all of the creature, the spell's size and the rod can't regain hit points it had the new modifier.
> While lit, the magic of the object so it's attacks, you can be cast in this way.
> You and the target. On subsequent turns, the basilisk until the creature's success at damaging an object.
>
>
> ###  Languages
> | 2 | + 1).
> #  Salamander
>_Medium ooze, unaligned_
>
>**Condition Immunities** charmed, the target.
>
> | 10 | 6 (1d10) |
>| Medium (barrel, chandelier) | 14 | 11 (+ 5 to hit, reach, the target's properties and becomes a creature becomes a  **_lesser restoration_**, your walking speed, you can be cured, the target is the area, the dragon retains its normal form.
>_Large dragon, unaligned_
>
>**Breath Weapons (Recharge 5–6).** This armor is made from the spell slot of the creature's, rounded down. name: Rope of Climbing
>_Medium undead, or both of the duration, a creature of the new form (the target's range. The unicorn can take your action to shake it awake.
>**Condition Immunities** poisoned
>**Speed** 30 ft., swim 60 ft., one you are normally attracted to, you are hit by this damage, and to any check you make a long rest, the target, and a creature in a spell is, the following flaws:
>**Components:** 30 feet high, or the spell is a creature.
>**Speed** 40 ft., darkvision 60 ft., passive Perception 13
>
>**Condition Immunities** charmed, you lose a level, you cast the spell you choose this archetype, but not yet sworn to it, it permanently turns to stone and is pushed 5 feet of the duration.
> #  Ice Mephit
>_Armor (chain mail)
>**Range:** 1 minute
> A spectral, floating hand appears at a creature, and to a spell and a spell using a 1st - level transmutation_
>**Charge.** _Melee Weapon Attack:_ 1 (1d4) | 10 ft.
>**Divine Awareness.** When you reach 3rd level, and the target is already charmed, and is blinded for 1 minute | 1 | - | 6 (−2) | - | 3 |
>| 3rd | + 3 |
>| 14 | + 5) | 23 | + 30).
> For the spell. name: Warding Bond
> level: 5
>**Duration:** 1 (1d4 + 3)
>**Water Breathing.** _Melee Weapon Attack:_ 1 (- 2 |
> |---------|---------|---------|---------|---------|---------|
> | STR | DEX | CON | INT | WIS | CHA |
>
>**Hand Crossbow.** _Melee Weapon Attack:_ 19 (+ 1)
>
>**Components:** V, M (a pair of platinum rings worth at least as tall and have advantage and roll a d20 if you can choose a creature in the swarm has advantage on a creature makes a Wisdom of 15 (natural armor)
>**Casting Time:** 12 (+ 5) | 1 | + 2
>
>**Multiattack.** The target regains 4d8 + 2
>
>**Duration:** V, S
>**Slam.** _Melee Weapon Attack:_ + 15). If you drink this potion, you fail.
> Creatures and objects as if they are wearing and carrying, up to your Charisma modifier + your proficiency bonus to damage, any creature that fails a DC 12 Wisdom (Perception) check.
> #  Crystal Ball of Telepathy
> type: humanoid
> cr:  . 125
>
>**Senses** passive Perception 10
>**Range:** Instantaneous
>
> ##  Attack
> If the target
>*  (a) two martial weapons, including your last turn.
>**Shortsword.** The target has cover and the spell for its wielder acts in a place of the tarrasque can use an action to enter a hostile creature that it and the spell's background reveals where you cast an evocation spell that the target, the fire. name: Dragon Slayer
> - - great expanses of solid stone.
>
>**Slowing Breath.** The vampire has the following additional properties. When the creature can't protect the warded creature with an object that has a + 1), you can see the creature. The swarm can't interfere with the spell effect.
>**Claws.** The target can use an action you can make a DC 10 Constitution saving throw proficiencies, or other number more than its normal bulk and weight, the DC is 10 feet. | 1 | + 6, the spell has the creature to no more than its AC, you'll ignore everything else to pursue a craft or use its claws and one with a DC, the object, or they can't, the swarm's command, the area.
>_Medium humanoid, it takes any damage. | 1 action | 1 piercing damage. |
> | 12 | 4 | 10, you cast an evocation spell you cast a wizard, you take a bonus to a + 3, and water.
>**Languages** -
>**Range:** 1 (200 XP)
>**Saving Throws** Str + 7 to hit, and other circumstances.
>
>
>_Medium beast, but no more than one object of your move or to turn one creature swallowed at a creature can use its reaction.
>
>
> #  Paladin
> | 20 | 25 |
>
>**Size.** Melee Spell Attack:_ + 4 | + 1 to 4, you have the same roll, the same, however.
> You can take 3 (- 2 | 2 |
> | 12 | + 1)
>_5th - level evocation_
>**At Higher Levels.** When a spell, the sphere's liquid continuously contracts to a DC of 5 or lower or one with a spell's spell is a small, but it must succeed on a damage type of your choice within range that are a 5th - level evocation_
>**Components:** Touch
>**Damage Resistances** acid, poison, a druid, you receive is.
>**Condition Immunities** necrotic, thunder
>**Hit Points
>**Components:** Self
>**Damage Immunities** poison, and no larger than the target, the elemental's weapon attacks. It also has 50 feet wide that extends out from your hand.
>
> ##  Challenge
> A Large creature or a solid surface, such as  **_dominate monster_**  (1 / 2 (−4) |
>
>**Range.** When you have two ranges. The flame sheds bright light shines 30 feet
>**Damage Immunities** lightning, the creature ends its turn and can move.
>_8th - level transmutation_
>
>
>
>**Languages.** _Melee Weapon Attack:_ + 7, Cha + 16 to hit, and you must succeed on a point it regains the use of the slots can be destroyed when you cast the spell you know the target, or is within range.
> #  Wand of the attack's reach or if you can breathe air and water, it has no effect.
>**Range:** Until dispelled
>
> #  The Environment
> By the same area.
>**Senses** darkvision 60 ft., one target._Hit:_ + 8) | 12 (+ 2) | - | - |
>
>
>**Moan.** _Melee Weapon Attack:_ + 7 | + 5)
>**Challenge** 5 ft., passive Perception 11
>**Saving Throws** Str + 9) |
> | 74 - 75 | The creature's space if that spell.
>_Wondrous item, and you are always fixed in your space, or half as much damage.
>**Spell Storing.** The target's AC and Dexterity saving throw.
> This item also has darkvision out to the saving throw or become frightened for the spell or an unoccupied space that is a creature.
>_Large undead, chaotic evil_
>**Keen Senses.** Your base walking speed by 5.
> This wand has 7 charges.
> For example, the helm and its area.
>
> At 1st level, one can succeed, the same proficiency from two different sources, such as darkness, and can repeat the saving throw.
> #  Giant Badger
>_4th - level transmutation (ritual)_
>
>* You can have a swimming speed.
>**At Higher Levels.** The vrock has advantage on the spell's hit points equal to the character.
>**Hit.** The hag has advantage on a DC, the  **_detect thoughts_** and the Pact Magic |
>| 2nd | + 6) | + 4), very rare (+ 8)
>**Duration:** Instantaneous
>
> ###  Damage Types
> Different fighters choose different targets.
> Once a spell
>**Condition Immunities** poison
>**Innate Spellcasting.** _Melee Weapon Attack:_ + 0) | 15 (3d6 + 5) | 8 | 3 | 9 | 4 (+ 0 to hit, you control it.
> ###  Ability Score Increase.** This effect ends, the damage.
>
> #  Gloves of Swimming and Climbing
> type: celestial
>
>**Speed** 60 feet away from you as an enemy or a surface or a helm, you revert and take no damage if you have resistance to the same turn. Any equipment it is a 1, the corpse can't speak, or until the target, it dies, and Intelligence, Wisdom, and behave in any other creatures, and can see within 10 feet, or another spell or a new one.
>* Athletics
>
> ###  Senses
> The wand can sense the presence of the  **_disintegrate_**
> You gain one of the target.
>
>_8th - level spell, or torn, it can. If the armor. Additionally, you make a Constitution saving throw against your spell slots by consulting the table, or have prepared, and duration.
> Activation of the  ** spell** tells you that has the spell again. name: Belt of Giant | Strength | Rarity |
>
>**Range.** A creature, and can see it, and Charisma (Intimidation) check (the spell again.
>
> A wall of fire, or you are good - - the spell's, rounded down, the creature regains its spent legendary actions at all.
> Heavy armor doesn't detect a creature, the spell requires an action.
>**Push, Drag, or carry.
>**Duration:** Instantaneous
>
>**Hit Points** 17 (+ 3 | 3 | 1 lb. (or 5) bludgeoning damage.
>
>**Web (Recharge 5–6).** bludgeoning
>**Multiattack.** Because of the event, or when you learn to speak the same target. If a creature the devil's area can be used again.
> name: Ice Storm
>_Wondrous item, unless that modifier is negative.
>
>
>
>**Leadership (Very Rare).
>**Challenge** 1 (200 XP)
>**Bite.** When you roll a number of

## Building

Point a compiler at it. Only tested with msvc and clang on Windows.

## Licenses

dnd.md is derived from [5thSRD](https://github.com/vitusventure/5thSRD).

> ## OPEN GAME LICENSE  Version  1.0a
>
> The following text  is  the  property  of  Wizards  of  the  Coast, Inc. and  is  Copyright  2000  Wizards  of  the  Coast, Inc ("Wizards").  All  Rights  Reserved.
>
> 1. Definitions: (a)"Contributors"  means  the  copyright and/or trademark  owners  who  have  contributed Open Game  Content;  (b)"Derivative  Material" means copyrighted  material  including  derivative works and  translations  (including  into  other computer languages),  potation,  modification,  correction, addition, extension,  upgrade,  improvement, compilation, abridgment  or  other  form in which  an  existing  work  may  be  recast,  transformed or adapted;  (c)  "Distribute"  means  to  reproduce, license, rent,  lease,  sell,  broadcast,  publicly display, transmit  or  otherwise  distribute;  (d)"Open Game Content"  means  the  game  mechanic  and includes the  methods,  procedures,  processes  and routines to  the  extent  such  content  does  not  embody the Product  Identity  and  is  an  enhancement  over the prior  art  and  any  additional  content  clearly  identified as Open  Game  Content  by  the  Contributor,  and means any  work  covered  by  this  License,  including translations and  derivative  works  under  copyright law, but  specifically  excludes  Product  Identity. (e) "Product  Identity"  means  product  and  product line names,  logos  and  identifying  marks  including trade dress;  artifacts;  creatures  characters;  stories, storylines, plots,  thematic  elements,  dialogue,  incidents, language, artwork,  symbols,  designs,  depictions, likenesses, formats,  poses,  concepts,  themes and graphic,  photographic  and  other  visual  or audio representations;  names  and  descriptions  of  characters, spells, enchantments,  personalities,  teams, personas, likenesses  and  special  abilities;  places, locations, environments,  creatures,  equipment, magical or  supernatural  abilities  or  effects, logos, symbols,  or  graphic  designs;  and  any  other trademark or  registered  trademark  clearly  identified as Product  identity  by  the  owner  of  the  Product Identity, and  which  specifically  excludes  the  Open Game Content;  (f)  "Trademark"  means  the  logos, names, mark,  sign,  motto,  designs  that  are  used by a  Contributor  to  identify  itself  or  its  products or the  associated  products  contributed  to  the Open Game  License  by  the  Contributor  (g)  "Use",  "Used" or "Using"  means  to  use,  Distribute,  copy,  edit,  format, modify, translate  and  otherwise  create  Derivative Material of  Open  Game  Content.  (h)  "You"or  "Your"  means  the  licensee  in  terms  of  this  agreement.
> 2.  The  License:  This  License  applies  to  any  Open  Game  Content  that  contains  a  notice  indicating  that  the  Open  Game  Content  may  only  be  Used  under  and  in  terms  of  this  License.  You  must  affix  such  a  notice  to  any  Open  Game  Content  that  you  Use.  No  terms  may  be  added  to  or  subtracted  from  this  License  except  as  described  by  the  License  itself.  No  other  terms  or  conditions  may  be  applied  to  any  Open  Game  Content  distributed  using  this  License.
> 3. Offer  and  Acceptance:  By  Using  the  Open  Game  Content  You  indicate  Your  acceptance  of  the  terms  of  this  License.
> 4. Grant  and  Consideration:  In  consideration  for  agreeing  to  use  this  License,  the  Contributors  grant  You  a  perpetual,  worldwide,  royalty-free,  non-exclusive  license  with  the  exact  terms  of  this  License  to  Use,  the  Open  Game  Content.
> 5. Representation  of  Authority  to  Contribute:  If  You  are  contributing  original  material  as  Open  Game  Content,  You  represent  that  Your  Contributions  are  Your  original  creation  and/or  You  have  sufficient  rights  to  grant  the  rights  conveyed  by  this  License.
> 6. Notice  of  License  Copyright:  You  must  update  the  COPYRIGHT  NOTICE  portion  of  this  License  to  include  the  exact  text  of  the  COPYRIGHT  NOTICE  of  any  Open  Game  Content  You  are  copying,  modifying  or  distributing,  and  You  must  add  the  title,  the  copyright  date,  and  the  copyright  holder's  name  to  the  COPYRIGHT  NOTICE  of  any  original  Open  Game  Content  you  Distribute.
> 7.  Use  of  Product  Identity:  You  agree  not  to  Use  any  Product  Identity,  including  as  an  indication  as  to  compatibility,  except  as  expressly  licensed  in  another,  independent  Agreement  with  the  owner  of  each  element  of  that  Product  Identity.  You  agree  not  to  indicate  compatibility  or  co-adaptability  with  any  Trademark  or  Registered  Trademark  in  conjunction  with  a  work  containing  Open  Game  Content  except  as  expressly  licensed  in  another,  independent  Agreement  with  the  owner  of  such  Trademark  or  Registered  Trademark.  The  use  of  any  Product  Identity  in  Open  Game  Content  does  not  constitute  a  challenge  to  the  ownership  of  that  Product  Identity.  The  owner  of  any  Product  Identity  used  in  Open  Game  Content  shall  retain  all  rights,  title  and  interest  in  and  to  that  Product  Identity.
> 8.  Identification:  If  you  distribute  Open  Game  Content  You  must  clearly  indicate  which  portions  of  the  work  that  you  are  distributing  are  Open  Game  Content.
> 9.  Updating  the  License:  Wizards  or  its  designated  Agents  may  publish  updated  versions  of  this  License.  You  may  use  any  authorized  version  of  this  License  to  copy,  modify  and  distribute  any  Open  Game  Content  originally  distributed  under  any  version  of  this  License.
> 10.  Copy  of  this  License:  You  MUST  include  a  copy  of  this  License  with  every  copy  of  the  Open  Game  Content  You  Distribute.
> 11.  Use  of  Contributor  Credits:  You  may  not  market  or  advertise  the  Open  Game  Content  using  the  name  of  any  Contributor  unless  You  have  written  permission  from  the  Contributor  to  do  so.
> 12.  Inability  to  Comply:  If  it  is  impossible  for  You  to  comply  with  any  of  the  terms  of  this  License  with  respect  to  some  or  all  of  the  Open  Game  Content  due  to  statute,  judicial  order,  or  governmental  regulation  then  You  may  not  Use  any  Open  Game  Material  so  affected.
> 13.  Termination:  This  License  will  terminate  automatically  if  You  fail  to  comply  with  all  terms  herein  and  fail  to  cure  such  breach  within  30  days  of  becoming  aware  of  the  breach.  All  sublicenses  shall  survive  the  termination  of  this  License.
> 14.  Reformation:  If  any  provision  of  this  License  is  held  to  be  unenforceable,  such  provision  shall  be  reformed  only  to  the  extent  necessary  to  make  it  enforceable.
> 15.  COPYRIGHT  NOTICE    Open  Game  License  v  1.0a  Copyright  2000,  Wizards  of  the  Coast,  LLC.
>
> System  Reference  Document  5.1  Copyright  2016,  Wizards  of  the  Coast,  Inc.;  Authors  Mike  Mearls,  Jeremy  Crawford,  Chris  Perkins,  Rodney  Thompson,  Peter  Lee,  James  Wyatt,  Robert  J.  Schwalb,  Bruce  R.  Cordell,  Chris  Sims,  and  Steve  Townshend,  based  on  original  material  by  E.  Gary  Gygax  and  Dave  Arneson.
>
> END  OF  LICENSE
